name: python-json-body-transform
version: v1.0.0
description: >
  Transforms JSON request and response bodies.
  On request: injects configurable key-value fields into the JSON body before
  forwarding to upstream.
  On response: masks sensitive fields in the JSON body to prevent leaking
  credentials or PII to downstream consumers.
runtime: python

processingMode:
  requestHeaderMode: PROCESS
  requestBodyMode: BUFFER
  responseHeaderMode: PROCESS
  responseBodyMode: BUFFER

parameters:
  type: object
  properties:
    injectFields:
      type: object
      description: >
        Key-value pairs to merge into the top-level JSON request body.
        Existing fields with the same name are overwritten.
      additionalProperties: true
      default: {}
      example:
        x-gateway-source: api-platform
        x-request-env: production
    maskFields:
      type: array
      description: >
        Names of top-level JSON fields in the response body whose values
        should be replaced with maskValue to prevent sensitive data leakage.
      items:
        type: string
      default: []
      example:
        - password
        - token
        - secret
    maskValue:
      type: string
      description: Replacement string written over masked field values.
      default: "****"

systemParameters:
  type: object
  properties: {}
